{% extends 'base.html' %}
{% block content %}
<div class="chat-room">
    <div class="messages" id="message-list">
        {% for message in messages %}
        <div class="message {% if message.sender == user %}own{% endif %}" id="msg-{{ message.id }}">
            <img src="{{ message.sender.avatar.url|default:'/static/images/default-avatar.png' }}" class="avatar-tiny">
            <span class="sender">{{ message.sender.get_display_name }}</span>
            <span class="time">{{ message.timestamp|time:"H:i" }}</span>
            <div class="content">{{ message.content }}</div>
        </div>
        {% endfor %}
    </div>
    <div class="message-input">
        <textarea id="chat-message" placeholder="Введите сообщение..."></textarea>
        <button id="send-message">Отправить</button>
        <div id="emoji-picker"></div>
    </div>
</div>
<script>
    const conversationId = {{ conversation.id }};
</script>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        initChatSocket(conversationId);
    });
</script>
{% endblock %}